#!/bin/bash
# threadKill.sh V. 1.0
# Written by Frank Walsh 2/14/2020
# Takes the child TID passed from VSP to killl the offending PID
# Tested on VSP 1.2.4.4-GA
NOW=$(date)
list_descendants ()
{
  local children=$(ps -o pid= --ppid "$1")

  for pid in $children
  do
    list_descendants "$pid"
  done

   for pid2 in $children
   do
     kill -9 $pid2
     echo Killing "$pid2"
   done
}
list_descendants $1
echo $NOW "- Buffer Error Detected - Killing thread" $1
kill -9 $1
exit 0
